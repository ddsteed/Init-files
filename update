#!/usr/bin/env  zsh
#
#-----------------------------------------------------------------------
# This script is to update all Mac/Linux softwares
#
# Author: Hao Feng (F1)
# Date:   Mar. 13, 2022
#
# Copyright (c) 2022, RDS
#-----------------------------------------------------------------------

if [[ $2 == "" ]]; then
    if [[ `uname` == "Darwin" ]]; then
        update=(mac abrew ibrew aconda mconda ai)
    elif [[ `uname` == "Linux" ]]; then
        update=(apt)
    fi
else
    update=($2)
fi

echoline () {
    echo "--------------------------------------------------"
}
    
function printc_d {
    bg=44
    fg=37
    txt=$1
    echo -e "\033[${bg};${fg}m${txt}\033[0m"
}

num=0
total=${#update[@]}

for mission in ${update[@]}; do
    let num++
    echo
    echoline
    printc_d "[$num/$total]: "

    case $mission in
        mac)
            printc_d " Updating Mac OS system & softwares ... "
            echo
            
            softwareupdate --all --install --force
            ;;
        abrew)
            printc_d " Updating Homebrew (arm) applications ... "
            echo

            source  ~/Init/arm
            abrewup
            abrew cleanup
            ;;
        ibrew)
            printc_d " Updating Homebrew (x86_64) applications ... "
            echo

            source ~/Init/x86
            ibrewup
            ibrew cleanup
            ;;
        aconda | mconda | ai)
            printc_d " Updating $mission ... "
            echo

            source ~/Init/$mission
            condaup
            if [[ $mission == aconda ]]; then acondaup; fi
            conda clean --all --yes
            ;;
        apt)
            printc_d " Updating Ubuntu Linux apt softwares ... "
            echo

            sudo apt-get update -y && sudo apt-get upgrade -y
            sudo apt-get autoremove -y
            ;;
        *)
            printc_d " $mission is NOT in the update lists ..."
            echo
            ;;
    esac
done
